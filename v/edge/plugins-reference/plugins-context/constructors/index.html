<!doctype html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="msapplication-TileColor" content="#FFFFFF">
  <meta name="msapplication-TileImage" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/mstile-144x144.png">
  <meta name="msapplication-square70x70logo" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/mstile-70x70.png">
  <meta name="msapplication-square150x150logo" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/mstile-150x150.png">
  <meta name="msapplication-wide310x150logo" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/mstile-310x150.png">
  <meta name="msapplication-square310x310logo" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/mstile-310x310.png">
  <meta name="google-site-verification" content="luspUdq52gkUU0FFChQ2xmeXSs5HDafpARQ7fVXVBp4">
  
  <!-- Schema.org markup for Google+ -->
  <meta itemprop="name" content="constructors">
  <meta itemprop="image" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/favicon-196x196.png">
  
  <!-- Twitter Card data -->
  <meta name="twitter:card" value="summary">
  <meta name="twitter:site" content="@kuzzleio">
  <meta name="twitter:title" content="constructors">
  <meta name="twitter:creator" content="@kuzzleio">
  <meta name="twitter:image" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/favicon-196x196.png">
  
  <!-- Open Graph data -->
  <meta property="og:title" content="constructors">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="">
  <meta property="og:image" content="https://stafyniaksacha.github.io/documentation/v/edge/assets/images/favicon/favicon-96x96.png">
  <meta property="article:published_time" content="2017-05-21T13:38:01.601Z">
  <meta property="article:modified_time" content="2017-05-21T13:38:01.601Z">
  <meta property="article:section" content="Plugins Reference">
  <meta property="article:tag" content="The plugin context">
  
  
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/documentation/v/edge/assets/images/favicon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/documentation/v/edge/assets/images/favicon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/documentation/v/edge/assets/images/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/documentation/v/edge/assets/images/favicon/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/documentation/v/edge/assets/images/favicon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/documentation/v/edge/assets/images/favicon/favicon-128.png" sizes="128x128">
  
  <link rel="stylesheet" href="/documentation/v/edge/assets/font-awesome/scss/font-awesome.css">
  <link href="//fonts.googleapis.com/css?family=Ubuntu:400,500,700" rel="stylesheet">
  
  <title>
      constructors
      - The plugin context
      - Plugins Reference
       -
  
     Kuzzle documentation
  </title>

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/atom-one-light.min.css">

  <link href="/documentation/v/edge/assets/stylesheets/full/screen.css" rel="stylesheet" type="text/css" media="screen">
</head>

<body class="index">
<header>
  <div class="wrapper">
    <div id="logo">
      <a href="http://kuzzle.io/">&#xA0;</a>
    </div>

    <a class="mobile-nav-burger" href="javascript:;"></a>

    <nav>
      <ul>
        <li>
          <a href="http://kuzzle.io/kuzzle-entreprise" class="nav-item">product</a>
        </li>
        <li>
          <a href="https://stafyniaksacha.github.io/documentation/v/edge/" class="nav-item developers active">Documentation</a>
          <ul class="mobile-nav">
              <li>
                <a href="/documentation/v/edge/guide"><span>Guide</span></a>
              </li>
              <li>
                <a href="/documentation/v/edge/sdk-reference"><span>SDK Reference</span></a>
              </li>
              <li>
                <a href="/documentation/v/edge/kuzzle-dsl"><span>Kuzzle DSL</span></a>
              </li>
              <li>
                <a href="/documentation/v/edge/validation-reference"><span>Data Validation</span></a>
              </li>
              <li>
                <a href="/documentation/v/edge/api-documentation"><span>API Documentation</span></a>
              </li>
              <li class="active">
                <a href="/documentation/v/edge/plugins-reference"><span>Plugins Reference</span></a>

                <ul class="sub-nav">
                  <li>
                    <a href="/documentation/v/edge/plugins-reference/plugins-creation-prerequisites"><span>Plugins creation prerequisites</span></a>
                  </li>
                  <li>
                    <a href="/documentation/v/edge/plugins-reference/plugins-features"><span>Plugins features</span></a>
                  </li>
                  <li>
                    <a href="/documentation/v/edge/plugins-reference/managing-plugins"><span>Managing Plugins</span></a>
                  </li>
                  <li class="active">
                    <a href="/documentation/v/edge/plugins-reference/plugins-context"><span>The plugin context</span></a>
                  </li>
                  <li>
                    <a href="/documentation/v/edge/plugins-reference/kuzzle-events-list"><span>Kuzzle events list</span></a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="/documentation/v/edge/elasticsearch-cookbook"><span>Elasticsearch Cookbook</span></a>
              </li>
          </ul>
        </li>
        <li>
          <a href="http://kuzzle.io/demos-tutorials/" class="nav-item ">Demos</a>
        </li>
        <li>
          <a href="http://kuzzle.io/blog/" class="nav-item ">Blog</a>
        </li>
        <li>
          <a href="http://kuzzle.io/contact/" class="nav-item ">Contact</a>
        </li>
        <li>
          <a href="https://github.com/kuzzleio/kuzzle" target="_blank" class="nav-item github">
            <i class="icon icon-github icon-small"></i>
          </a>
        </li>
      </ul>
    </nav>
  </div>
  <div class="developer-nav open">
    <ul class="search">
      <li>
        <input name="search" type="search" placeholder="search" tabindex="1">
        <!-- <input name="search" type="search" placeholder="search"></input> -->
      </li>
    </ul>
    <ul class="nav">
        <li>
          <a href="/documentation/v/edge/guide"><span>Guide</span></a>
        </li>
        <li>
          <a href="/documentation/v/edge/sdk-reference"><span>SDK Reference</span></a>
        </li>
        <li>
          <a href="/documentation/v/edge/kuzzle-dsl"><span>Kuzzle DSL</span></a>
        </li>
        <li>
          <a href="/documentation/v/edge/validation-reference"><span>Data Validation</span></a>
        </li>
        <li>
          <a href="/documentation/v/edge/api-documentation"><span>API Documentation</span></a>
        </li>
        <li class="active">
          <a href="/documentation/v/edge/plugins-reference"><span>Plugins Reference</span></a>
        </li>
        <li>
          <a href="/documentation/v/edge/elasticsearch-cookbook"><span>Elasticsearch Cookbook</span></a>
        </li>
    </ul>

    <div class="search-results"><ul></ul></div>

    <script type="text/plain" id="search-results-template">
      <li>
        <a href="__link__" tabindex="__tabindex__">
          <p class="page">
            <span class="title">__title__</span>
            <span class="firstMember">__firstMember__</span>
            <span class="parent">__parent__</span>
          </p>
          <p class="preview">__preview__</p>
        </a>
      </li>
    </script>
  </div>
</header>

<div class="container">
  <div class="tocify-wrapper">
    <ul class="search-results"></ul>
  
    <div class="tocify">
      <ul class="tocify-header">
        <li class="tocify-item tocify-focus tocify-hover"></li>
      </ul>
      <ul class="tocify-header">
        <li class="tocify-item"><a style="color: #111; text-decoration: none;" href="https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference" title="back to Plugins Reference home">Plugins Reference</a></li>
        <ul class="tocify-subheader">
  
              <li class="tocify-item"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/plugins-creation-prerequisites" title="requirements to develop your plugin">Plugins creation prerequisites</a></li>
  
              <li class="tocify-item"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/plugins-features" title="understand Kuzzle plugins mechanisms">Plugins features</a></li>
  
              <li class="tocify-item"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/managing-plugins" title="learn how to enable and configure plugins">Managing Plugins</a></li>
  
          <li class="tocify-item tocify-focus"><a style="color: #FFF; text-decoration: none;" href="#" title="plugin initialization context attribute reference">The plugin context</a></li>
            <ul class="tocify-header">
              <ul class="tocify-subheader">
                      <li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/plugins-context" title="plugin initialization context attribute reference">&#x203A; Introductions</a></li>
                      <li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/plugins-context/accessors" title="accessors">&#x203A; accessors</a></li>
                      <li class="tocify-item tocify-level-2 tocify-focus"><a style="color: #FFF; text-decoration: none;" href="/documentation/v/edge/plugins-reference/plugins-context/constructors" title="constructors">&#x203A; constructors</a></li>
                      <li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/plugins-context/errors" title="errors">&#x203A; errors</a></li>
                      <li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/plugins-context/log" title="log">&#x203A; log</a></li>
              </ul>
            </ul>
  
              <li class="tocify-item"><a style="color: #002835; text-decoration: none;" href="/documentation/v/edge/plugins-reference/kuzzle-events-list" title="list of events that plugins can register hooks and pipes">Kuzzle events list</a></li>
        </ul>
      </ul>
      <ul class="toc-footer">
        <!-- community links here ! -->
  
            <li><a href="/documentation/">1.0.0-RC9 (latest)</a></li>
            <li><span style="color:#717171">1.0.0-RC10 (next)</span></li>
      </ul>
    </div>
  </div>

  <div class="page-wrapper">
    <div class="toc">
      <ul>
        <li class="toc-item toc-level-1">
            <a href="#constructors" title="constructors">
              constructors
            </a>
        </li>
        <li class="toc-item toc-level-2">
            <a href="#basevalidationtype" title="BaseValidationType">
              BaseValidationType
            </a>
        </li>
        <li class="toc-item toc-level-2">
            <a href="#dsl" title="Dsl">
              Dsl
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#exists" title="exists">
              exists
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#getfilterids" title="getFilterIds">
              getFilterIds
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#register" title="register">
              register
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#remove" title="remove">
              remove
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#test" title="test">
              test
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#validate" title="validate">
              validate
            </a>
        </li>
        <li class="toc-item toc-level-2">
            <a href="#repository" title="Repository">
              Repository
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#create" title="create">
              create
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#createorreplace" title="createOrReplace">
              createOrReplace
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#delete" title="delete">
              delete
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#get" title="get">
              get
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#mget" title="mGet">
              mGet
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#replace" title="replace">
              replace
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#search" title="search">
              search
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#update" title="update">
              update
            </a>
        </li>
        <li class="toc-item toc-level-2">
            <a href="#request" title="Request">
              Request
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#response-getheader" title="response.getHeader">
              response.getHeader
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#response-removeheader" title="response.removeHeader">
              response.removeHeader
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#setheader" title="setHeader">
              setHeader
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#serialize" title="serialize">
              serialize
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#seterror" title="setError">
              setError
            </a>
        </li>
        <li class="toc-item toc-level-3">
            <a href="#setresult" title="setResult">
              setResult
            </a>
        </li>
      </ul>
    </div>

    <div class="content">

      <div class="mobile-breadcrumb">
        <p>
        <a href="https://stafyniaksacha.github.io/documentation/v/edge/">Kuzzle documentation</a>
      
          &#xBB; <a href="https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference">Plugins Reference</a>
          &#xBB; <a href="https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference/plugins-context">The plugin context</a>
      
          &#xBB; constructors
         </p>
      </div>
      
      <div class="nav-sibling">
        <div class="nav-left">
          <p>
            <a href="https://github.com/stafyniaksacha/documentation/edit/forked-rcx-refactor-doc-deploy/src/plugins-reference/plugins-context/constructors.md">edit on github<i class="icon icon-github icon-small"></i></a>
            <span class="separator">|</span>
            <a href="https://github.com/stafyniaksacha/documentation/issues/new?labels=plugins-reference&amp;title=Feedback%20about%20page%20&apos;plugins-reference/plugins-context/constructors.md&apos;">send feedback about this content<i class="icon icon-github icon-small"></i></a>
            <span class="separator">|</span>
            <select class="rate-documentation">
              <option value=""></option>
              <option value="1">Unusable documentation</option>
              <option value="2">Poor documentation</option>
              <option value="3">OK documentation</option>
              <option value="4">Good documentation</option>
              <option value="5">Excellent documentation</option>
            </select>
          </p>
        </div>
        <div class="nav-right">
          <p>
            <a href="https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference/plugins-context/accessors">&#xAB; accessors</a>
            <span class="separator">|</span>
            <a href="https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference/plugins-context/errors">errors &#xBB;</a>
          </p>
        </div>
        <div style="clear:both"></div>
      </div>

      <div class="toc-inline">
        <ul>
          <li class="toc-item toc-level-1">
              <a href="#constructors" title="constructors">
                constructors
              </a>
          </li>
          <li class="toc-item toc-level-2">
              <a href="#basevalidationtype" title="BaseValidationType">
                BaseValidationType
              </a>
          </li>
          <li class="toc-item toc-level-2">
              <a href="#dsl" title="Dsl">
                Dsl
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#exists" title="exists">
                exists
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#getfilterids" title="getFilterIds">
                getFilterIds
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#register" title="register">
                register
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#remove" title="remove">
                remove
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#test" title="test">
                test
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#validate" title="validate">
                validate
              </a>
          </li>
          <li class="toc-item toc-level-2">
              <a href="#repository" title="Repository">
                Repository
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#create" title="create">
                create
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#createorreplace" title="createOrReplace">
                createOrReplace
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#delete" title="delete">
                delete
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#get" title="get">
                get
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#mget" title="mGet">
                mGet
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#replace" title="replace">
                replace
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#search" title="search">
                search
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#update" title="update">
                update
              </a>
          </li>
          <li class="toc-item toc-level-2">
              <a href="#request" title="Request">
                Request
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#response-getheader" title="response.getHeader">
                response.getHeader
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#response-removeheader" title="response.removeHeader">
                response.removeHeader
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#setheader" title="setHeader">
                setHeader
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#serialize" title="serialize">
                serialize
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#seterror" title="setError">
                setError
              </a>
          </li>
          <li class="toc-item toc-level-3">
              <a href="#setresult" title="setResult">
                setResult
              </a>
          </li>
        </ul>
      </div>

      <div class="main-content">
        <h1><a class="anchor" id="constructors"></a>constructors</h1>
<hr>
<h2><a class="anchor" id="basevalidationtype"></a><code>BaseValidationType</code></h2>
<p>The <code>BaseValidationType</code> constructor provides a base to create your own validation types.
It provides a common structure for all validation types developped in Kuzzle.</p>
<p>You can find an example of a type creation in the
<a href="https://github.com/kuzzleio/kuzzle/blob/master/lib/api/core/validation/types/type.js.template">Kuzzle source code</a>.</p>
<hr>
<h2><a class="anchor" id="dsl"></a><code>Dsl</code></h2>
<p>The DSL constructor provided in the plugin context gives access to <a href="/documentation/v/edge/kuzzle-dsl">Kuzzle DSL capabilities</a>.<br>It allows managing filters, and testing data to get a list of matching filters.</p>
<p>Each plugin can instantiate its own sandboxed DSL instance:</p>
<pre><code class="hljs js"><span class="hljs-keyword">var</span> dsl = <span class="hljs-keyword">new</span> context.constructors.Dsl();</code></pre>

<p>The DSL exposes the following methods:</p>
<h3><a class="anchor" id="exists"></a><code>exists</code></h3>
<p>Returns a boolean indicating if filters exist for an index-collection pair</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>index</code></td>
<td><code>string</code></td>
<td>Data index name</td>
</tr>
<tr>
<td><code>collection</code></td>
<td><code>string</code></td>
<td>Data collection name</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns <code>true</code> if at least one filter exists on the provided index-collection pair, returns <code>false</code> otherwise</p>
<h3><a class="anchor" id="getfilterids"></a><code>getFilterIds</code></h3>
<p>Retrieves filter IDs registered on an index-collection pair</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>index</code></td>
<td><code>string</code></td>
<td>Data index name</td>
</tr>
<tr>
<td><code>collection</code></td>
<td><code>string</code></td>
<td>Data collection name</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>An <code>array</code> of <code>filterId</code> corresponding to filters registered on an index-collection pair.</p>
<h3><a class="anchor" id="register"></a><code>register</code></h3>
<p>Registers a filter to the DSL.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>index</code></td>
<td><code>string</code></td>
<td>Data index name</td>
</tr>
<tr>
<td><code>collection</code></td>
<td><code>string</code></td>
<td>Data collection name</td>
</tr>
<tr>
<td><code>filters</code></td>
<td><code>object</code></td>
<td>Filters in <a href="/documentation/v/edge/kuzzle-dsl">Kuzzle DSL</a> format</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>A <code>promise</code> resolving to an object containing the following attributes:</p>
<ul>
<li><code>id</code>: the filter unique identifier</li>
<li><code>diff</code>: <code>false</code> if the filter already existed in the engine. Otherwise, contains an object with the canonical version of the provided filters</li>
</ul>
<h3><a class="anchor" id="remove"></a><code>remove</code></h3>
<p>Removes all references to a given filter from the DSL</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filterId</code></td>
<td><code>string</code></td>
<td>Filter unique ID. Obtained by using <code>register</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>A <code>promise</code> resolved once the filter has been completely removed from the DSL</p>
<h3><a class="anchor" id="test"></a><code>test</code></h3>
<p>Test data against filters registered in the DSL, returning matching filter IDs, if any.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>index</code></td>
<td><code>string</code></td>
<td>Data index name</td>
</tr>
<tr>
<td><code>collection</code></td>
<td><code>string</code></td>
<td>Data collection name</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>object</code></td>
<td>Data to test against filters</td>
</tr>
<tr>
<td><code>documentId</code></td>
<td><code>string</code></td>
<td>If applicable, document unique ID</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>An array of <code>filterId</code> matching the provided data (and/or documentId, if any).</p>
<h3><a class="anchor" id="validate"></a><code>validate</code></h3>
<p>Tests the provided filters without storing them in the system, to check whether they are well-formed or not.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>filters</code></td>
<td><code>object</code></td>
<td>Filters in <a href="/documentation/v/edge/kuzzle-dsl">Kuzzle DSL</a> format</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>A resolved promise if the provided filters are valid, or a rejected one with the appropriate error object otherwise.</p>
<hr>
<h2><a class="anchor" id="repository"></a><code>Repository</code></h2>
<p>The Repository constructor provided in the plugin context gives access to methods
that allow the plugin to interact with its plugin storage. The plugin storage is a dedicated
index in Elasticsearch where the plugin can <a href="/documentation/v/edge/plugins-reference/plugins-context/accessors/#storage-createcollection">create collections</a>.
To do so the plugin should first <a href="/documentation/v/edge/plugins-reference/plugins-context/accessors/#storage-bootstrap">bootstrap</a> the index.</p>
<p>Once done, the plugin can instantiate repositories to interact with the different collections it created.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>collection</code></td>
<td><code>string</code></td>
<td>The collection linked to the repository</td>
</tr>
<tr>
<td><code>ObjectConstructor</code></td>
<td><code>constructor function</code></td>
<td>(optional) Will be used as constructor for the fetched documents instead of <code>Object</code></td>
</tr>
</tbody>
</table>
<p><strong>Usage</strong></p>
<p>Each plugin can instantiate its own repositories linked to its own sandboxed plugin storage:</p>
<pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ObjectConstructor</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.someProperty = <span class="hljs-string">&apos;someValue&apos;</span>;
}

<span class="hljs-keyword">var</span> someCollectionRepository = <span class="hljs-keyword">new</span> context.constructors.Repository(<span class="hljs-string">&apos;someCollection&apos;</span>, ObjectConstructor);</code></pre>

<p>The Repository exposes the following methods:</p>
<h3><a class="anchor" id="create"></a><code>create</code></h3>
<p>Creates a document in the plugin storage.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>document</code></td>
<td><code>Object</code></td>
<td>The document you want to create. It must contain a unique <code>_id</code> string property. You don&apos;t need to worry about collisions with other plugins as your plugin storage is only accessible by your plugin</td>
</tr>
<tr>
<td><code>options</code></td>
<td><code>Object</code></td>
<td>Optional arguments</td>
</tr>
</tbody>
</table>
<p>If a raw <code>options</code> object is provided, it may contain:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>refresh</code></td>
<td><code>string</code></td>
<td>Value can only be <code>wait_for</code> if provided. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.x/docs-refresh.html">Elasticsearch documentation</a> for more information.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an object respresentation of Elasticsearch request result.</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.create({
  <span class="hljs-attr">_id</span>: <span class="hljs-string">&apos;&lt;a unique id&gt;&apos;</span>,
  <span class="hljs-attr">someField</span>: <span class="hljs-string">&apos;some content&apos;</span>,
  <span class="hljs-attr">anotherField</span>: <span class="hljs-string">&apos;another content&apos;</span>,
  ...
})
  .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(result);
  });

<span class="hljs-comment">/**
 * Outputs:
 * { _index: &apos;%some-plugin&apos;,
 *   _type: &apos;someCollection&apos;,
 *   _id: &apos;&lt;a unique id&gt;&apos;,
 *   _version: 1,
 *   result: &apos;created&apos;,
 *   _shards: { total: 2, successful: 1, failed: 0 },
 *   created: true,
 *   _source: { someField: &apos;some content&apos;, anotherField: &apos;another content&apos; } }
 */</span></code></pre>

<aside class="warning">
  The document provided as argument should be a plain object representing the document you want to store.
</aside>

<h3><a class="anchor" id="createorreplace"></a><code>createOrReplace</code></h3>
<p>Creates or replaces a document in the plugin storage.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>document</code></td>
<td><code>object</code></td>
<td>The document you want to create or replace. It must contain a unique <code>_id</code> string property. You don&apos;t need to worry about collisions with other plugins as your plugin storage is only accessible by your plugin</td>
</tr>
<tr>
<td><code>options</code></td>
<td><code>Object</code></td>
<td>Optional arguments</td>
</tr>
</tbody>
</table>
<p>If a raw <code>options</code> object is provided, it may contain:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>refresh</code></td>
<td><code>string</code></td>
<td>Value can only be <code>wait_for</code> if provided. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.x/docs-refresh.html">Elasticsearch documentation</a> for more information.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an object representation of Elasticsearch request result (see <a href="/documentation/v/edge/plugins-reference/plugins-context/constructors/#create">create usage</a>).</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.createOrReplace({
  <span class="hljs-attr">_id</span>: <span class="hljs-string">&apos;&lt;a unique id&gt;&apos;</span>,
  <span class="hljs-attr">someField</span>: <span class="hljs-string">&apos;some content&apos;</span>,
  <span class="hljs-attr">anotherField</span>: <span class="hljs-string">&apos;another content&apos;</span>,
  ...
});</code></pre>

<aside class="warning">
  The document provided as argument should be a plain object representing the document you want to store.
</aside>

<h3><a class="anchor" id="delete"></a><code>delete</code></h3>
<p>Deletes a document from the plugin storage.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>document</code></td>
<td><code>object</code></td>
<td>The document <code>_id</code> of the document you want to delete.</td>
</tr>
<tr>
<td><code>options</code></td>
<td><code>Object</code></td>
<td>Optional arguments</td>
</tr>
</tbody>
</table>
<p>If a raw <code>options</code> object is provided, it may contain:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>refresh</code></td>
<td><code>string</code></td>
<td>Value can only be <code>wait_for</code> if provided. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.x/docs-refresh.html">Elasticsearch documentation</a> for more information.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an array of objects which is a representation of the Elasticsearch request result.</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.delete(<span class="hljs-string">&apos;someDocumentId&apos;</span>)
  .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(result);
  });

<span class="hljs-comment">/**
 * Outputs:
 *  [ { found: true,
 *    _index: &apos;%some-plugin&apos;,
 *    _type: &apos;someCollection&apos;,
 *    _id: &apos;&lt;a unique id&gt;&apos;,
 *    _version: 3,
 *    result: &apos;deleted&apos;,
 *    _shards: { total: 2, successful: 1, failed: 0 } } ]
 */</span></code></pre>

<h3><a class="anchor" id="get"></a><code>get</code></h3>
<p>Retrieves a document from the plugin storage.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>documentId</code></td>
<td><code>string</code></td>
<td>The document identifier of the document you want to retrieve.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an <code>Object</code> or an <code>ObjectConstructor</code> if provided in the constructor.</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.get(<span class="hljs-string">&apos;someDocumentId&apos;</span>, <span class="hljs-string">&apos;someCollection&apos;</span>);</code></pre>

<h3><a class="anchor" id="mget"></a><code>mGet</code></h3>
<p>Retrieves multiple documents from the plugin storage.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>documentIds</code></td>
<td><code>array&lt;string&gt;</code></td>
<td>An array of document identifier of the documents you want to retrieve.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an array of <code>Object</code> or <code>ObjectConstructor</code> if provided in the constructor.</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.mGet([<span class="hljs-string">&apos;someDocumentId&apos;</span>, <span class="hljs-string">&apos;anotherDocument&apos;</span>]);</code></pre>

<h3><a class="anchor" id="replace"></a><code>replace</code></h3>
<p>Replaces a document in the plugin storage.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>document</code></td>
<td><code>object</code></td>
<td>The content of the document. It must contain a unique <code>_id</code> string property.</td>
</tr>
<tr>
<td><code>options</code></td>
<td><code>Object</code></td>
<td>Optional arguments</td>
</tr>
</tbody>
</table>
<p>If a raw <code>options</code> object is provided, it may contain:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>refresh</code></td>
<td><code>string</code></td>
<td>Value can only be <code>wait_for</code> if provided. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.x/docs-refresh.html">Elasticsearch documentation</a> for more information.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an object respresentation of Elasticsearch request result (see <a href="/documentation/v/edge/plugins-reference/plugins-context/constructors/#create">create usage</a>).</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.replace({
  <span class="hljs-attr">_id</span>: <span class="hljs-string">&apos;&lt;a unique id&gt;&apos;</span>,
  <span class="hljs-attr">someField</span>: <span class="hljs-string">&apos;some content&apos;</span>,
  <span class="hljs-attr">anotherField</span>: <span class="hljs-string">&apos;another content&apos;</span>,
  ...
});</code></pre>

<aside class="warning">
  The document provided as argument should be a plain object representing the document you want to store.
</aside>

<h3><a class="anchor" id="search"></a><code>search</code></h3>
<p>Searches documents that match the provided <code>query</code> in the collection.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>query</code></td>
<td><code>object</code></td>
<td>The <a href="/documentation/v/edge/elasticsearch-cookbook/basic-queries">query</a> sent to Elastisearch.</td>
</tr>
<tr>
<td><code>from</code></td>
<td><code>integer</code></td>
<td>Provides the offset of the returned documents.</td>
</tr>
<tr>
<td><code>size</code></td>
<td><code>integer</code></td>
<td>Provides the count of the returned documents.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an object of the form <code>{total: number, hits: array&lt;object&gt;}</code> where <code>hits</code>
contains an array of <code>Object</code> or <code>ObjectConstructor</code> if provided in the constructor and <code>total</code> the count of documents that match the query.</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.search({
  <span class="hljs-attr">query</span>: {
    <span class="hljs-attr">match_all</span>: {}
  }
}, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>);</code></pre>

<h3><a class="anchor" id="update"></a><code>update</code></h3>
<p>Updates a document in the plugin storage. You can provide a partial document to add or update one or more fields.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>document</code></td>
<td><code>object</code></td>
<td>The partial content of the document. It must contain a unique <code>_id</code> string property.</td>
</tr>
<tr>
<td><code>options</code></td>
<td><code>Object</code></td>
<td>Optional arguments</td>
</tr>
</tbody>
</table>
<p>If a raw <code>options</code> object is provided, it may contain:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>refresh</code></td>
<td><code>string</code></td>
<td>Value can only be <code>wait_for</code> if provided. See <a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.x/docs-refresh.html">Elasticsearch documentation</a> for more information.</td>
</tr>
</tbody>
</table>
<p><strong>Returns</strong></p>
<p>Returns a <code>promise</code> that resolves to an object which is a representation of the Elasticsearch request result.</p>
<p><strong>Usage</strong></p>
<pre><code class="hljs js">someCollectionRepository.update({
  <span class="hljs-attr">_id</span>: <span class="hljs-string">&apos;&lt;a unique id&gt;&apos;</span>,
  <span class="hljs-attr">anotherField</span>: <span class="hljs-string">&apos;changed content&apos;</span>
});
<span class="hljs-comment">/**
 * Outputs:
 * { _index: &apos;%some-plugin&apos;,
 *   _type: &apos;someCollection&apos;,
 *   _id: &apos;&lt;a unique id&gt;&apos;,
 *   _version: 2,
 *   result: &apos;updated&apos;,
 *   _shards: { total: 0, successful: 0, failed: 0 } }
 */</span></code></pre>

<hr>
<h2><a class="anchor" id="request"></a><code>Request</code></h2>
<p>This constructor is used to transform an <a href="/documentation/v/edge/api-documentation/query-syntax/common-attributes">API call</a> into a standardized Kuzzle request. This object is updated along the request process to reflect the current state of the request, and is ultimately used to serialize a standard <a href="/documentation/v/edge/api-documentation/kuzzle-response">Kuzzle response</a> to be forwarded to the requesting client.</p>
<p>Network protocol specific headers can be added to the response. If the protocol can handle them,
these headers will be used to configure the response sent to the client.<br>As Kuzzle supports the HTTP protocol natively, this object handles HTTP headers special cases.
Other network protocols headers are stored in raw format, and protocol plugins need to handle
their own specific headers manually.</p>
<p>For more information about this object, please check <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#request">our detailed documentation</a>.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>request</code></td>
<td><code>Request</code></td>
<td><code>Request</code> object used to derive a new object instance</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>object</code></td>
<td>JSON object following the same standard than for non-HTTP <a href="/documentation/v/edge/api-documentation/query-syntax">API calls</a><br>See the  <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#modelsrequestinput">RequestInput</a> constructor for more information</td>
</tr>
<tr>
<td><code>options</code></td>
<td><code>object</code></td>
<td>Optional initialization parameters</td>
</tr>
</tbody>
</table>
<p>If a raw <code>options</code> object is provided, it may contain:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>connectionId</code></td>
<td><code>string</code></td>
<td>Passed to <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#modelsrequestcontext">RequestContext</a> constructor</td>
</tr>
<tr>
<td><code>error</code></td>
<td><code>KuzzleError</code> or <code>Error</code></td>
<td>Invokes <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#seterrorerror">setError</a> at initialization</td>
</tr>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>Passed to <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#modelsrequestcontext">RequestContext</a> constructor</td>
</tr>
<tr>
<td><code>requestId</code></td>
<td><code>string</code></td>
<td>Initializes the <code>id</code> property</td>
</tr>
<tr>
<td><code>result</code></td>
<td><em>(varies)</em></td>
<td>Invokes <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#setresultresult-options--null">setResult</a> at initialization</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>integer</code></td>
<td>HTTP error code</td>
</tr>
<tr>
<td><code>token</code></td>
<td><code>object</code></td>
<td>Passed to <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#modelsrequestcontext">RequestContext</a> constructor</td>
</tr>
<tr>
<td><code>user</code></td>
<td><code>object</code></td>
<td>Passed to <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#modelsrequestcontext">RequestContext</a> constructor</td>
</tr>
</tbody>
</table>
<p>Here is an example:</p>
<pre><code class="hljs js"><span class="hljs-keyword">let</span> derivedRequest = <span class="hljs-keyword">new</span> context.constructors.Request(request, {
  <span class="hljs-attr">controller</span>: <span class="hljs-string">&apos;write&apos;</span>,
  <span class="hljs-attr">action</span>: <span class="hljs-string">&apos;create&apos;</span>,
  <span class="hljs-attr">index</span>: <span class="hljs-string">&apos;foo&apos;</span>,
  <span class="hljs-attr">collection</span>: <span class="hljs-string">&apos;bar&apos;</span>,
  <span class="hljs-attr">_id</span>: <span class="hljs-string">&apos;some document ID&apos;</span>,
  <span class="hljs-attr">body</span>: {
    <span class="hljs-attr">document</span>: <span class="hljs-string">&apos;content&apos;</span>
  },
  <span class="hljs-attr">volatile</span>: {
    <span class="hljs-attr">some</span>: <span class="hljs-string">&apos;volatile data&apos;</span>
  }
});</code></pre>

<p><strong>Attributes</strong></p>
<p>Read-only</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>origin</code></td>
<td><code>Request</code></td>
<td><code>null</code></td>
<td>The first request of a requests chain</td>
</tr>
<tr>
<td><code>previous</code></td>
<td><code>Request</code></td>
<td><code>null</code></td>
<td>The previous request of a requests chain</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>integer</td>
<td>Request creation timestamp</td>
</tr>
</tbody>
</table>
<p>Writable</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>Auto-generated UUID</td>
<td>Request unique identifier</td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>integer</code></td>
<td><code>102</code></td>
<td>HTTP status code</td>
</tr>
</tbody>
</table>
<p>Any undefined attribute from the list above will be set to null.</p>
<p>Please refer to our <a href="/documentation/v/edge/api-documentation">API Documentation</a> for a complete list of controllers-actions and their purposes.</p>
<p>Getters</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>context</code></td>
<td><code>RequestContext</code></td>
<td><a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#modelsrequestcontext">RequestContext</a> object</td>
<td>Request connection context</td>
</tr>
<tr>
<td><code>error</code></td>
<td><code>KuzzleError</code></td>
<td><code>null</code></td>
<td>Request error, if any</td>
</tr>
<tr>
<td><code>input</code></td>
<td><code>RequestInput</code></td>
<td><a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#modelsrequestinput">RequestInput</a> object</td>
<td>Request&apos;s parameters</td>
</tr>
<tr>
<td><code>response</code></td>
<td><code>RequestResponse</code></td>
<td>Response view of the request, standardized as the expected <a href="/documentation/v/edge/api-documentation/kuzzle-response">Kuzzle API response</a></td>
</tr>
<tr>
<td><code>result</code></td>
<td><em>(varies)</em></td>
<td><code>null</code></td>
<td>Request result, if any</td>
</tr>
</tbody>
</table>
<h3><a class="anchor" id="response-getheader"></a><code>response.getHeader</code></h3>
<p>Returns the value registered for the response header <code>name</code></p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Header name</td>
</tr>
</tbody>
</table>
<h3><a class="anchor" id="response-removeheader"></a><code>response.removeHeader</code></h3>
<p>Removes header <code>name</code> from the response headers.</p>
<h3><a class="anchor" id="setheader"></a><code>setHeader</code></h3>
<p>Adds a header <code>name</code> with value <code>value</code> to the response headers.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Header name</td>
</tr>
<tr>
<td><code>value</code></td>
<td><code>string</code></td>
<td>Header value</td>
</tr>
</tbody>
</table>
<p>For standard headers, if <code>name</code> already exists, then the provided <code>value</code> will be concatenated
to the existing value, separated by a comma.  </p>
<p>As Kuzzle implements HTTP natively, this behavior changes for some HTTP specific headers,
to comply with the norm. For instance <code>set-cookie</code> values are amended in an array, and other headers like <code>user-agent</code> or <code>host</code> can store only 1 value.</p>
<h3><a class="anchor" id="serialize"></a><code>serialize</code></h3>
<p>Serializes the <code>Request</code> object into a pair of POJOs that can be sent across the network, and then used to rebuild another equivalent <code>Request</code> object.</p>
<pre><code class="hljs js"><span class="hljs-keyword">let</span> foo = request.serialize();
<span class="hljs-keyword">let</span> bar = <span class="hljs-keyword">new</span> context.constructors.Request(request, foo.data, foo.options);</code></pre>

<h3><a class="anchor" id="seterror"></a><code>setError</code></h3>
<p>Adds an error to the request, and sets the request&apos;s status to the error one.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>error</code></td>
<td><code>KuzzleError</code> or <code>Error</code></td>
<td>Error object to set</td>
</tr>
</tbody>
</table>
<p>If a <code>KuzzleError</code> is provided, the request&apos;s status attribute is set to the error one.</p>
<p>Otherwise, the provided error is encapsulated into a <a href="https://github.com/kuzzleio/kuzzle-common-objects/blob/master/README.md#errorsinternalerror">InternalError</a> object, and the request&apos;s status is set to 500.</p>
<h3><a class="anchor" id="setresult"></a><code>setResult</code></h3>
<p>Sets the request&apos;s result.</p>
<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>result</code></td>
<td><em>(varies)</em></td>
<td>Request&apos;s result</td>
</tr>
<tr>
<td><code>options</code></td>
<td><code>object</code></td>
<td>Optional parameters</td>
</tr>
</tbody>
</table>
<p>The <code>options</code> argument may contain the following properties:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td><code>integer</code></td>
<td>HTTP status code</td>
<td><code>200</code></td>
</tr>
<tr>
<td><code>headers</code></td>
<td><code>object</code></td>
<td>Protocol specific headers</td>
<td><code>null</code></td>
</tr>
<tr>
<td><code>raw</code></td>
<td><code>boolean</code></td>
<td>Asks Kuzzle to send the provided result directly,instead of encapsulating it in a Kuzzle JSON response</td>
<td><code>false</code></td>
</tr>
</tbody>
</table>

        <div style="clear: both"></div>
      </div>

      <hr>
      <div id="disqus_thread"></div>
      
      <script async>
        var disqus_developer = 1;
      
        var disqus_config = function () {
          this.page.url = 'https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference/plugins-context/constructors';
          this.page.title = 'constructors';
          this.page.identifier = 'plugins-reference/plugins-context/constructors';
        };
      
        (function() {
          var d = document, s = d.createElement('script');
          s.src = 'https://kuzzle-documentation.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>

      <div class="nav-sibling bottom">
        <div class="nav-left">
          <p>
            <a href="https://github.com/stafyniaksacha/documentation/edit/forked-rcx-refactor-doc-deploy/src/plugins-reference/plugins-context/constructors.md">edit on github<i class="icon icon-github icon-small"></i></a>
            <span class="separator">|</span>
            <a href="https://github.com/stafyniaksacha/documentation/issues/new?labels=plugins-reference&amp;title=Feedback%20about%20page%20&apos;plugins-reference/plugins-context/constructors.md&apos;">send feedback about this content<i class="icon icon-github icon-small"></i></a>
            <span class="separator">|</span>
            <select class="rate-documentation">
              <option value=""></option>
              <option value="1">Unusable documentation</option>
              <option value="2">Poor documentation</option>
              <option value="3">OK documentation</option>
              <option value="4">Good documentation</option>
              <option value="5">Excellent documentation</option>
            </select>
          </p>
        </div>
        <div class="nav-right">
          <p>
            <a href="https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference/plugins-context/accessors">&#xAB; accessors</a>
            <span class="separator">|</span>
            <a href="https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference/plugins-context/errors">errors &#xBB;</a>
          </p>
        </div>
        <div style="clear:both"></div>
      </div>
    </div>
  </div>
</div>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
<script src="/documentation/v/edge/assets/javascript/lib/jquery.barrating.js"></script>

<script type="text/javascript">
  // store helper
  var store = function store(key, value) {
    var lsSupport = false;

    // Check for native support
    if (localStorage) {
      lsSupport = true;
    }

    // If value is detected, set new or modify store
    if (typeof value !== "undefined" && value !== null) {
      // Convert object values to JSON
      if ( typeof value === 'object' ) {
        value = JSON.stringify(value);
      }
      // Set the store
      if (lsSupport) { // Native support
        localStorage.setItem(key, value);
      } else { // Use Cookie
        createCookie(key, value, 30);
      }
    }

    // No value supplied, return value
    if (typeof value === "undefined") {
      // Get value
      if (lsSupport) { // Native support
        data = localStorage.getItem(key);
      } else { // Use cookie
        data = readCookie(key);
      }

      // Try to parse JSON...
      try {
        data = JSON.parse(data);
      }
      catch(e) {
        data = data;
      }

      return data;
    }

    // Null specified, remove store
    if (value === null) {
      if (lsSupport) { // Native support
        localStorage.removeItem(key);
      } else { // Use cookie
        createCookie(key, '', -1);
      }
    }

    /**
     * Creates new cookie or removes cookie with negative expiration
     * @param  key       The key or identifier for the store
     * @param  value     Contents of the store
     * @param  exp       Expiration - creation defaults to 30 days
     */
    function createCookie(key, value, exp) {
      var date = new Date();
      date.setTime(date.getTime() + (exp * 24 * 60 * 60 * 1000));
      var expires = "; expires=" + date.toGMTString();
      document.cookie = key + "=" + value + expires + "; path=/";
    }

    /**
     * Returns contents of cookie
     * @param  key       The key or identifier for the store
     */
    function readCookie(key) {
      var nameEQ = key + "=";
      var ca = document.cookie.split(';');
      for (var i = 0, max = ca.length; i < max; i++) {
        var c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }
  };






  // google analytics
  (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
              (i[r].q = i[r].q || []).push(arguments)
          }, i[r].l = 1 * new Date();
      a = s.createElement(o),
          m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
  })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

  ga('create', 'UA-67035328-1', 'auto');
  ga('send', 'pageview');

  (function scrollToHash() {
    if (window.location.hash != '') {
      var anchor = $(location.hash).get(0);
      if (anchor) {
        anchor.scrollIntoView();
      }
    }
  })();




  (function mobileNavBuger() {
    var $body = $('body');

    $('.mobile-nav-burger').on('click', function() {
      $body.toggleClass('nav-burger-open');
    });
  })();







  (function rateDocumentation() {
    var $rateDocumentation = $('.rate-documentation');
    var pagePath = 'plugins-reference/plugins-context/constructors'.replace(/\//g, '-');
    var categoryRating = parseInt(store('rate-documentation-' + pagePath));

    $rateDocumentation.barrating({
      theme: 'fontawesome-stars',
      initialRatting: 0,
      allowEmpty: true,
      onSelect: function(value, text, event) {
        if (typeof(event) !== 'undefined') {
          // rating was selected by a user
          store('rate-documentation-' + pagePath, event.target.dataset.ratingValue);
          $rateDocumentation.barrating('set', event.target.dataset.ratingValue);
          // $rateDocumentation.barrating('readonly', true); // wired on mobile

          ga('send', 'event', {
            eventCategory: 'documentation-rate',
            eventAction: 'https://stafyniaksacha.github.io/documentation/v/edge/plugins-reference/plugins-context/constructors',
            eventLabel: event.target.dataset.ratingText,
            transport: 'beacon'
          });

          window.setTimeout(function() {
            $('.br-current-rating').css('transition', 'opacity 0.15s');
            $('.br-current-rating').css('opacity', '0');

            window.setTimeout(function() {
              $('.br-current-rating').css('transition', 'opacity 0.9s');
              $('.br-current-rating').text("thank's for feedback !");
              $('.br-current-rating').css('opacity', '1');
            }, 140);
          }, 1);

          window.setTimeout(function() {
            $('.br-current-rating').css('opacity', '0');

            window.setTimeout(function() {
              $('.br-current-rating').css('transition', 'opacity 0.2s');
              if (event.target.dataset.ratingText === 'Excellent documentation') {
                $('.br-current-rating').text(event.target.dataset.ratingText + ' \\o/');
              }
              else {
                $('.br-current-rating').text(event.target.dataset.ratingText);
              }
              $('.br-current-rating').css('opacity', '1');
            }, 1000);
          }, 2500);
        }
        else {
          // rating was selected programmatically
          // by calling `set` method
        }
      }
    });

    $('.br-current-rating').addClass('visible');

    if (!isNaN(categoryRating)) {
      $rateDocumentation.barrating('set', categoryRating);
      $rateDocumentation.barrating('readonly', true);
    }
  })();











  (function leftNavUX() {
    var $wrapper = $('.tocify-wrapper');

    if ($wrapper.length !== 0) {
      var $selectedItem = $('.tocify-level-2.tocify-focus', $wrapper);

      if ($selectedItem.length === 0) {
        $selectedItem = $('.tocify-focus', $wrapper);
      }

      if ($selectedItem.get(0).offsetTop + 120 > $wrapper.height()) {
        $wrapper.scrollTop(Math.ceil($selectedItem.get(0).offsetTop - $wrapper.height() / 2));
      }
    }
  })();









  (function tocUX() {
    var $toc = $('.toc');
    var $content = $('.content');

    //----------------------------
    // fixes toc next to content
    if ($toc.length > 0) {
      var debounceComputeSize = false;
      var computeSize = function() {
        // 280 is the width of left nav / 15 is the margin with content
        $toc.css('left', $content.get('0').offsetLeft + $content.get('0').offsetWidth + 280 + 15 +'px');
        // 30 is the margin with bottom window
        $toc.css('max-height', window.innerHeight - $toc.get('0').offsetTop - 30  + 'px');
      }

      $(window).on('resize', function() {
        clearTimeout(debounceComputeSize);
        debounceComputeSize = setTimeout(computeSize, 13);
      })
      computeSize();
    }
    //----------------------------

    //---------------------------------------------------------------------
    // toogle 'active' class on toc link when headings pass window offset
    if ($toc.length > 0) {
      var headings = {};
      var debounceActiveItem = false;
      var computeActiveItem = function() {
        var lastPassedItem;

        for (let key in headings) {
          headings[key].$link.removeClass('active');

          if (headings[key].offset <= window.pageYOffset + 70) {
            lastPassedItem = headings[key];
          }
        }

        if (lastPassedItem) {
          lastPassedItem.$link.addClass('active');
        }
      }

      $('a[href]', $toc).each(function(index, element) {
        var id = element.href.slice(element.href.indexOf('#'));
        var $ref = $(id).parent();

        if ($ref.length > 0) {
          headings[id] = {
            $ref: $ref,
            $link: $(element),
            offset: $ref.get('0').offsetTop
          }
        }
      });

      $(window).on('scroll', function() {
        clearTimeout(debounceActiveItem);
        debounceActiveItem = setTimeout(computeActiveItem, 10);
      })
      computeActiveItem();
    }
    //---------------------------------------------------------------------
  })();

















  //---------------------------------------------------------------------
  // copy code to clipboard button
  (function codeClipboard() {
    $hljs = $('.hljs');

    if ($hljs.length > 0) {
      var debounceClipboard = false;
      var clipboardSnippets;

      function fallbackMessage(action) {
          var actionMsg = '';
          var actionKey = (action === 'cut' ? 'X' : 'C');
          if (/iPhone|iPad/i.test(navigator.userAgent)) {
              actionMsg = 'No support :(';
          } else if (/Mac/i.test(navigator.userAgent)) {
              actionMsg = 'Press ⌘-' + actionKey + ' to ' + action;
          } else {
              actionMsg = 'Press Ctrl-' + actionKey + ' to ' + action;
          }
          return actionMsg;
      }

      $hljs.each(function(index, element) {
        $(element).before('<button class="clipboard" title="copy code to clipboard" data-clipboard-snippet><i class="fa fa-clipboard" aria-hidden="true"></i></button>');
      })

      clipboardSnippets = new Clipboard('[data-clipboard-snippet]', {
          target: function(trigger) {
              return trigger.nextElementSibling;
          }
      });

      clipboardSnippets.on('success', function(e) {
          e.clearSelection();
          $(e.trigger).text('Copied!')

          clearTimeout(debounceClipboard);
          debounceClipboard = setTimeout(function() {
            $(e.trigger).html('<i class="fa fa-clipboard" aria-hidden="true"></i>');
          }, 1200);
      });
      clipboardSnippets.on('error', function(e) {
        e.clearSelection();
        $(e.trigger).text(fallbackMessage(e.action));

        clearTimeout(debounceClipboard);
        debounceClipboard = setTimeout(function() {
          $(e.trigger).html('<i class="fa fa-clipboard" aria-hidden="true"></i>');
        }, 2400);
      });
    }
  })();
  //---------------------------------------------------------------------








  //---------------------------------------------------------------------
  // language tab selector
  (function languageTabSelector() {
    var $languageTabSelector = $('.language-tab-selector a');
    var pageCategory = 'plugins-reference'.replace(/\//g, '-');
    var selectedLanguage = store('selected-language' + pageCategory);

    if (selectedLanguage) {
      if ($('.language-tab[data-language="' + selectedLanguage + '"]').length > 0) {
        $('.language-tab-active').removeClass('language-tab-active');
        $('.language-tab-selector a[data-language-name="' + selectedLanguage + '"]').addClass('language-tab-active');
        $('.language-tab[data-language="' + selectedLanguage + '"]').addClass('language-tab-active');
      }
    }

    if ($languageTabSelector.length > 0) {
      $languageTabSelector.on('click touch', function(e) {
        e.preventDefault();
        e.stopPropagation();

        var language = $(this).data('languageName');

        $('.language-tab-active').removeClass('language-tab-active');
        $('.language-tab-selector a[data-language-name="' + language + '"]').addClass('language-tab-active');
        $('.language-tab[data-language="' + language + '"]').addClass('language-tab-active');

        store('selected-language' + pageCategory, language)
      });
    }
  })();
  //---------------------------------------------------------------------









  (function instantSearchUI() {
    var KEY_UP = 38;
    var KEY_DOWN = 40;
    var client = algoliasearch("4RFBRWISJR", "6febf1ebe906bd82bce58d5a20ac6c1b");
    var index = client.initIndex('kuzzle-documentation');
    var template = $('#search-results-template').html();
    var $searchInput = $('.search input[type=search]');
    var $searchResults = $('.search-results');
    var $searchResultsContainer = $('ul', $searchResults);
    var watchResultsDebounce = false;
    var selectedIndex = -1;
    var watchClose = false;
    var lastHits = 0;

    // focus search input on content loaded
    $searchInput.focus();


    $(window).on('keydown', function (event) {
      if (watchClose) {
        var $results = $('a', $searchResultsContainer);
        var $focusResult = $('a:hover, a:focus', $searchResultsContainer);

        if ($focusResult.length > 0) {
          $results.each(function(index, element) {
            console.log('key:', index, $results[index], $focusResult.get(0));

            if ($results[index] === $focusResult.get(0)) {
              selectedIndex = index;
            }
          })
        }

        console.log('post selectedIndex:', selectedIndex, $results.length, $focusResult.length);

        switch (event.keyCode) {
          case KEY_UP:
            event.stopPropagation();
            if (selectedIndex === 0) {
              selectedIndex = -1;
            }

            if (selectedIndex === -1) {
              $searchInput.focus();
              selectedIndex = $results.length - 1;
            }
            else {
              selectedIndex -= 1;
              $results.get(selectedIndex).focus();
            }
            //$('li:not(:last-child).selected').removeClass('selected').next().addClass('selected');

            return false;
          case KEY_DOWN:
            event.stopPropagation();
            if (selectedIndex >= $results.length -1) {
              $searchInput.focus();
              selectedIndex = -1;
            }
            else {
              selectedIndex += 1;
              $results.get(selectedIndex).focus();
            }
            //$('li:not(:first-child).selected').removeClass('selected').prev().addClass('selected');
            return false;
        }
      }
    });

    // search results open/close handlers
    $(window).on('click touch', function() {
      console.log('?')
      if (watchClose) {
        $searchResults.removeClass('display');
        watchClose = false;

        if (watchResultsDebounce) {
          window.clearTimeout(watchResultsDebounce);
        }
      }
    });

    $searchInput.on('click touch', function(event) {
      if (lastHits > 0) {
        $searchResults.addClass('display');
        watchClose = true;
      }
      event.stopPropagation();
    });

    $searchInput.on('focus', function(event) {
      if (lastHits > 0) {
        $searchResults.addClass('display');
        watchClose = true;
      }

      selectedIndex = -1;
    });

    $searchInput.on('blur', function(event) {
      if (lastHits > 0) {
        $searchResults.addClass('display');
        watchClose = true;
      }
    });
    // end - search results open/close handlers


    // main input listener
    $searchInput.on('input', function(event) {
      var $input = $(this);
      var searchResultsContent = '';
      // var length = (this.value.length + 1) * 6;

      selectedIndex = -1;

      // // resize input length to fit value
      // length = (length > 450) ? 450 : length;
      // this.style.width = (length > 220) ? length + 'px' : '220px';


      // clear search result on empty input
      if (this.value === '') {
        $searchResultsContainer.empty();
        $searchResults.removeClass('display');
        watchClose = false;

        return;
      }

      index.search(this.value, function(err, res) {
        if (err) {
          console.error(err);
          return;
        }

        lastHits = res.hits.length;
        if (watchResultsDebounce) {
          window.clearTimeout(watchResultsDebounce);
        }

        if (lastHits === 0) {
          $searchResultsContainer.empty();
          $searchResults.removeClass('display');
          return;
        }

        // send ga event when user has search results but does nothing
        watchResultsDebounce = window.setTimeout(function() {
          ga('send', 'event', {
            eventCategory: 'documentation-search',
            eventAction: (lastHits > 0) ? '<watch_results>' : '<no_results>',
            eventLabel: $searchInput.val(),
            transport: 'beacon'
          });
        }, 4000);

        $searchResults.addClass('display');
        watchClose = true;

        // make search result item from
        for (var key in res.hits) {
          var content = template;

          // here we secure manualy all xml tags wich may can be retrieved by results, but we keep <em> tags for highlighting
          var elements = res.hits[key]._snippetResult.content.value.split('<em>');
          var preview = '';

          for (var k in elements) {
            elements[k] = elements[k].replace(/</g, '&lt;');
            elements[k] = elements[k].replace(/>/g, '&gt;');
          }

          // restore <em></em> tags
          preview = elements.join('<em>');
          preview = preview.replace(/&lt;\/em&gt;/g, '</em>');

          // replace variables in template
          content = content.replace(/__tabindex__/g, key + 2);
          content = content.replace(/__link__/g, 'https://stafyniaksacha.github.io/documentation/v/edge/' + res.hits[key].path);
          content = content.replace(/__parent__/g, res.hits[key].parent || '');
          content = content.replace(/__firstMember__/g, res.hits[key].firstMember || '');
          content = content.replace(/__title__/g, res.hits[key]._highlightResult.title.value);
          content = content.replace(/__preview__/g, preview);

          searchResultsContent += content;
        }

        // add algolia copyright
        searchResultsContent += '<li style="text-align: right"><img src="https://www.algolia.com/assets/pricing_new/algolia-powered-by-ac7dba62d03d1e28b0838c5634eb42a9.svg" style="margin: 8px 8px 0 0;"></li>';

        // magic jQuery
        $searchResultsContainer.html(searchResultsContent);

        // send ga event on search result hit
        $('a', $searchResultsContainer).on('click touch', function(event) {
          ga('send', 'event', {
            eventCategory: 'documentation-search',
            eventAction: this.href,
            eventLabel: $searchInput.val(),
            transport: 'beacon'
          });
        });
      });
    });

  })();
</script>
</body>
</html>
